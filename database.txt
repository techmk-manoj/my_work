CREATE DATABASE shbs;

use shbs;


CREATE TABLE IF NOT EXISTS users (
  id INT(10) UNSIGNED NOT NULL AUTO_INCREMENT,
  username VARCHAR(32) NOT NULL UNIQUE,
  password VARCHAR(64) NOT NULL,
  enabled BOOLEAN NOT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE TABLE IF NOT EXISTS authorities (
  id INT(10) UNSIGNED NOT NULL AUTO_INCREMENT,
  username VARCHAR(32) NOT NULL,
  authority VARCHAR(32) NOT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY username_authority (username, authority),
  FOREIGN KEY (username) REFERENCES users(username) ON UPDATE CASCADE ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;

CREATE TABLE IF NOT EXISTS room_type (
    id INT(10) UNSIGNED UNIQUE NOT NULL AUTO_INCREMENT,
    type VARCHAR(32) NOT NULL,
    description VARCHAR(256),
    image VARCHAR(256),
    quantity INT(10) UNSIGNED DEFAULT 0,
    price decimal(12,2) UNSIGNED NOT NULL,
    created_at BIGINT UNSIGNED NOT NULL,
    updated_at BIGINT UNSIGNED NOT NULL,
    PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;


CREATE TABLE IF NOT EXISTS customer (
    id INT(10) UNSIGNED UNIQUE NOT NULL AUTO_INCREMENT,
    username VARCHAR(32) NOT NULL UNIQUE,
    password VARCHAR(64) NOT NULL,
    name VARCHAR(64) NOT NULL,
    created_at BIGINT UNSIGNED NOT NULL,
    updated_at BIGINT UNSIGNED NOT NULL,
	points BIGINT(20),
    PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;


CREATE TABLE IF NOT EXISTS reservation (
    id INT(10) UNSIGNED UNIQUE NOT NULL AUTO_INCREMENT,
    room_type_id INT(10) UNSIGNED NOT NULL,
    customer_id INT(10) UNSIGNED NOT NULL,
    quantity INT(10) UNSIGNED NOT NULL,
    start_date BIGINT UNSIGNED NOT NULL,
    end_date BIGINT UNSIGNED NOT NULL,
    cancelled BOOLEAN NOT NULL DEFAULT FALSE,
    created_at BIGINT UNSIGNED NOT NULL,
    updated_at BIGINT UNSIGNED NOT NULL,
    status varchar(20),
    amount_paid BIGINT(20),
    room_amout BIGINT(20),
    PRIMARY KEY (id),
    FOREIGN KEY (room_type_id) REFERENCES room_type(id) ON UPDATE CASCADE ON DELETE CASCADE,
    FOREIGN KEY (customer_id) REFERENCES customer(id) ON UPDATE CASCADE ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;


INSERT INTO users VALUES (1, 'admin', '$2a$10$4yB3di.lJb3/Uh6edRwAlOHU/h31PrcEssd79oS0sNmIHDmUAw9Wu', '1');
INSERT INTO authorities VALUES (1, 'admin', 'ROLE_ADMIN');
INSERT INTO room_type VALUES (1, "executive", "executive room only for 1 person", "", 30, 1000, 1612373010587, 1612373010587);
INSERT INTO customer VALUES (1, 'customer', '$2a$10$4yB3di.lJb3/Uh6edRwAlOHU/h31PrcEssd79oS0sNmIHDmUAw9Wu', 'Customer', 1612373010587, 1612373010587,4000);
INSERT INTO reservation VALUES (1, 1, 1, 5, 1612373010587, 1612373010587, FALSE, 1612373010587, 1612373010587,"Booked",2000,2000);
